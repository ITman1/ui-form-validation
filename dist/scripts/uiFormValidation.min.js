!function(window,document,undefined){"use strict";angular.module("uiFormValidation.constants",[]),angular.module("uiFormValidation.values",[]),angular.module("uiFormValidation.providers",[]),angular.module("uiFormValidation.services",["uiFormValidation.constants","uiFormValidation.values"]),angular.module("uiFormValidation.factories",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services"]),angular.module("uiFormValidation.controllers",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services","uiFormValidation.factories"]),angular.module("uiFormValidation.directives",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services","uiFormValidation.factories","uiFormValidation.controllers"]),angular.module("uiFormValidation",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services",,"uiFormValidation.factories","uiFormValidation.controllers","uiFormValidation.directives","uiFormValidation.providers","ngSanitize"]),angular.module("uiFormValidation.controllers").controller("validationErrorsController",function(i,o){this.parseControlErrorsSelectors=function(t){return i.isExpression(t)?(t=i.parseExpression(t),i.evalAndParseControlErrorsSelectors(o.$parent,t)):i.parseControlErrorsSelectors(t)}}),angular.module("uiFormValidation.controllers").controller("validationNoticeController",function(i,o){this.parseControlErrorsSelectors=function(t){return i.isExpression(t)?(t=i.parseExpression(t),i.evalAndParseControlErrorsSelectors(o.$parent,t)):i.parseControlErrorsSelectors(t)}}),angular.module("uiFormValidation.constants").constant("uiFormValidation.supportedValidations",{validateRequired:{validationName:"validateRequired",performableValidation:function(){return!0},validate:function(i){return!!i},errorMessage:function(){return"Field is required."}},validateAdhoc:{validationName:"validateAdhoc",performableValidation:function(){return!0},validate:function(i,o){var t=o.element.attr("validate-adhoc"),r=o.scope.$eval(t);return!r},errorMessage:function(i,o,t){var r=t.controlElement.attr("validate-adhoc"),n=o.$eval(r);return n}},validateLength:{validationName:"validateLength",performableValidation:function(){return!0},validate:function(i,o){return i&&i.length&&i.length>=parseInt(o.element.attr("validate-length"))},errorMessage:function(i,o,t){return"Expected text length with at least "+t.controlElement.attr("validate-length")+" characters."}},validateRegex:{validationName:"validateRegex",performableValidation:function(){return!0},validate:function(i,o){return new RegExp(o.element.attr("validate-regex")).test(i)},errorMessage:function(i,o,t){return"Value does not matches regular expression "+t.controlElement.attr("validate-regex")+"."}}}),angular.module("uiFormValidation.constants").constant("uiFormValidation.validationErrorsModes",{onSubmitAndInvalid:"onSubmitAndInvalid",onDirtyAndInvalid:"onDirtyAndInvalid",onInvalid:"onInvalid"}),angular.module("uiFormValidation.constants").constant("uiFormValidation.validationNoticeModes",{onSubmitAndInvalid:"onSubmitAndInvalid",onDirtyAndInvalid:"onDirtyAndInvalid",onInvalid:"onInvalid"}),angular.module("uiFormValidation.directives").directive("uiValidation",function(i,o,t,r){var n=1;return{restrict:"A",require:["uiValidation","form"],controller:function(i,a,e){var l=t.getValidationErrorsModes(),s=t.getValidationNoticeModes(),d=t.getValidationErrorsLocationFactories(),u=[];angular.forEach(d,function(i){u.push(a.get(i))}),this.controllerName=e.attr("name")||"uiValidation_"+n++,this.initialized=!1,this.isSubmited=!1,this.initializationCallbacks=[],this.formController=undefined,this.formElement=undefined,this.controls={},this.validationNoticeMode=o.validationNoticeMode,this.validationErrorsMode=o.validationErrorsMode,this.validationErrorsLocation=o.validationErrorsLocation,this.validationErrorsTemplate=o.validationErrorsTemplate;var c=this;this.initialize=function(i,o){c.controllerName=i.$name||c.controllerName,c.formController=i,c.formElement=o;var t=i.$addControl;i.$addControl=function(i){t(i),c.addControl(i)},angular.forEach(i,function(i){i&&i.hasOwnProperty("$modelValue")&&c.addControl(i)}),c.initialized=!0,angular.forEach(c.initializationCallbacks,function(i){i()})},this.addControl=function(i){if(i.$name&&""!==i.$name){var o={},t=this.formElement[0].querySelector('[name="'+i.$name+'"]');t=angular.element(t),o.control=i,o.controlElement=t,o.validationNoticeMode=undefined,o.validationErrorsMode=undefined,o.validationErrorsLocation=undefined,o.validationErrorsTemplate=undefined,c.controls[i.$name]=o}},this.afterInitialized=function(i){this.initialized?i():this.initializationCallbacks.push(i)},this.getValidationProperty=function(i,o){if(!c.controls[i])throw"Control with given name "+i+" does not exist.";var t=c.controls[i][o];return t?t:c[o]},this.getValidationErrorsMode=function(i){return this.getValidationProperty(i,"validationErrorsMode")},this.getValidationNoticeMode=function(i){return this.getValidationProperty(i,"validationNoticeMode")},this.getValidationErrorsTemplate=function(i){return this.getValidationProperty(i,"validationErrorsTemplate")},this.getValidationErrorsLocation=function(i){return this.getValidationProperty(i,"validationErrorsLocation")},this.hasControlErrors=function(i){var o=i.controlName,t=i.errors,r=this.controls[o];if(!r)throw"Control with name '"+o+"' does not exist.";var n=!1;return t?angular.forEach(t,function(i){r.control.$error[i]&&(n=!0)}):n=r.control.$invalid,n},this.hasControlsErrors=function(i){var o=!1;return angular.forEach(i,function(i){c.hasControlErrors(i)&&(o=!0)}),o},this.shouldNoticeForControlSelector=function(i){var o=i.controlName,t=this.getValidationNoticeMode(o),r=this.controls[o],n=this.hasControlErrors(i);if(!r)throw"Control with name '"+o+"' does not exist.";var a=!1,e=!1,l=!1;return-1!==t.indexOf(s.onSubmitAndInvalid)&&(a=this.isSubmited&&n),-1!==t.indexOf(s.onDirtyAndInvalid)&&(e=r.control.$dirty&&n),-1!==t.indexOf(s.onInvalid)&&(l=n),a||e||l},this.shouldNoticeForControlSelectors=function(i){var o=!1;return angular.forEach(i,function(i){c.shouldNoticeForControlSelector(i)&&(o=!0)}),o},this.shouldDisplayValidationErrorsForControlSelector=function(i){var o=i.controlName,t=this.getValidationErrorsMode(o),r=this.controls[o],n=this.hasControlErrors(i);if(!r)throw"Control with name '"+o+"' does not exist.";var a=!1,e=!1,s=!1;return-1!==t.indexOf(l.onSubmitAndInvalid)&&(a=this.isSubmited&&n),-1!==t.indexOf(l.onDirtyAndInvalid)&&(e=r.control.$dirty&&n),-1!==t.indexOf(l.onInvalid)&&(s=n),a||e||s},this.shouldDisplayValidationErrorsForControlSelectors=function(i){var o=!1;return angular.forEach(i,function(i){c.shouldDisplayValidationErrorsForControlSelector(i)&&(o=!0)}),o},this.getParsedValidationErrorsLocation=function(i){var o=this.getValidationErrorsLocation(i),t={name:"",args:[]},r=/^\s*(.*?)\s*(\{\s*([^\{\}]*?)\s*\})?$/,n=r.exec(o);if(null===n||4!==n.length)throw"Unable to parse validation errors location - '"+o+"'.";return t.name=n[1].trim(),t.args=n[3]?n[3].split(","):[],t},this.getFormOrControlWrapper=function(i){if(c.formElement[0]===i[0])return c;var o;return angular.forEach(c.controls,function(t){o||t.controlElement[0]!==i[0]||(o=t)}),o},this.injectValidationErrors=function(){angular.forEach(c.controls,function(o,t){var n=angular.element("<div></div>");n.attr("validation-errors",t),n.attr("validation-controller",c.controllerName),n.attr("validation-errors-template",c.getValidationErrorsTemplate(t));var a=c.getParsedValidationErrorsLocation(t);angular.forEach(u,function(t){if(t.name===a.name){var e=null;if(t.compile){if("function"!=typeof t.compile)throw"Validation attribute compile is not function.";e=t.compile(n,a.args)}else e=r(n);e(i,function(r){if(t.link){if("function"!=typeof t.link)throw"Validation attribute link is not function.";t.link(i,r,o,a.args)}})}})})},this.bindSubmitEvent=function(){this.formElement.bind("submit",function(){i.$apply(function(){c.submit()})})},this.validate=function(){angular.forEach(this.controls,function(i){var o=i.control.$viewValue;i.control.$setViewValue(o)})},this.submit=function(){var o=this.formElement.attr("ng-submit");o&&(this.isSubmited=!0,i.$eval(o))}},controllerAs:"uiValidationController",link:function(i,o,r,n){var a=n[0],e=n[1];o.attr("novalidate",!0),a.initialize(e,o),a.injectValidationErrors(),a.bindSubmitEvent(),t.addValidationController(i,a)}}}),angular.module("uiFormValidation.directives").directive("validationController",function(){return{restrict:"A",link:function(i,o,t){if("string"!=typeof t.validationController)throw"Invalid name of the validation controller."}}}),angular.module("uiFormValidation.directives").directive("validationErrors",function(i,o){return{replace:!0,restrict:"A",require:["^?uiValidation","validationErrors"],templateUrl:function(i){var t=i.attr("validation-errors-template");return t?t:o.validationErrorsTemplate},scope:{uiValidationController:"@",$index:"@"},controller:"validationErrorsController",link:function(t,r,n,a){var e=a[0],l=a[1],s=null;s=e?e.controllerName:n.validationController,i.addValidationErrorsController(t,s,l),t.errors={},i.afterValidationControllerInitialized(t,s,function(){var a=i.validationControllers[t][s],e=l.parseControlErrorsSelectors(n.validationErrors);t.$watch(function(){return a.shouldDisplayValidationErrorsForControlSelectors(e)},function(i){r.toggleClass("hidden",!i)}),angular.forEach(e,function(i){var r=a.controls[i.controlName];if(!r)throw"Undefined control '"+i.controlName+'" to watch.';t.$watchCollection(function(){return r.control.$error},function(){if(i.errors&&i.errors.length<1)return void(t.errors={});var n={};n.control=r.control,n.controlElement=n.controlElement,n.errors={},r.control&&r.control.$error&&angular.forEach(r.control.$error,function(e,l){var s=o.formValidations[l];i.errors&&-1==i.errors.indexOf(l)?delete n.errors[l]:e&&s?n.errors[l]=s.errorMessage(l,t.$parent,r,a):e&&(n.errors[l]=o.defaultErrorMessage(l,t.$parent,r,a))}),t.errors[i.controlName]=n})})})}}}),angular.module("uiFormValidation.directives").directive("validationErrorsLocation",function(){return{restrict:"A",require:"^uiValidation",link:function(i,o,t,r){r.afterInitialized(function(){var i=r.getFormOrControlWrapper(o);if(!i)throw"Unable to get element wrapper. Directive validation-errors-location is not placed probably on the form or input element.";i.validationErrorsLocation=t.validationErrorsLocation})}}}),angular.module("uiFormValidation.directives").directive("validationErrorsMode",function(){return{restrict:"A",require:"^uiValidation",link:function(i,o,t,r){r.afterInitialized(function(){var i=r.getFormOrControlWrapper(o);if(!i)throw"Unable to get element wrapper. Directive validation-errors-mode is not placed probably on the form or input element.";i.validationErrorsMode=t.validationErrorsMode.split("\\s+")})}}}),angular.module("uiFormValidation.directives").directive("validationErrorsTemplate",function(){return{restrict:"A",require:"^uiValidation",link:function(i,o,t,r){r&&r.afterInitialized(function(){var i=r.getFormOrControlWrapper(o);i&&(i.validationErrorsTemplate=t.validationErrorsTemplate)})}}}),angular.module("uiFormValidation.directives").directive("validationNotice",function(){return{restrict:"A",require:["^uiValidation","validationNotice"],controller:"validationNoticeController",link:function(i,o,t,r){var n=r[0],a=r[1],e=t.validationNotice,l=a.parseControlErrorsSelectors(e);n.afterInitialized(function(){i.$watch(function(){return n.shouldNoticeForControlSelectors(l)},function(i){o.toggleClass("has-error",i)})})}}}),angular.module("uiFormValidation.directives").directive("validationNoticeMode",function(){return{restrict:"A",require:"^uiValidation",link:function(i,o,t,r){r.afterInitialized(function(){var i=r.getFormOrControlWrapper(o);if(!i)throw"Unable to get element wrapper. Directive validation-notice-mode is not placed probably on the form or input element.";i.validationNoticeMode=t.validationNoticeMode.split("\\s+")})}}}),angular.module("uiFormValidation.directives").directive("validationSubmit",function(i,o){return{restrict:"A",link:function(i,t,r){o.afterValidationControllerInitialized(i,r.validationSubmit,function(){var n=o.validationControllers[i][r.validationSubmit];t.bind("click",function(){i.$apply(function(){n.submit()})})})}}}),angular.module("uiFormValidation.factories").factory("uiFormValidation.validationErrorsLocation.after",function(i){return{name:"after",link:function(o,t,r,n){var a=r.controlElement;if(n.length>0){var e=i.selectFromScope(a,n[0]);e&&(a=e)}a.after(t)}}}),angular.module("uiFormValidation.factories").factory("uiFormValidation.validationErrorsLocation.append",function(i){return{name:"append",link:function(o,t,r,n){var a=r.controlElement;if(n.length>0){var e=i.selectFromScope(a,n[0]);e&&(a=e)}a.append(t)}}}),angular.module("uiFormValidation.factories").factory("uiFormValidation.validationErrorsLocation.explicit",function(){return{name:"explicit",compile:function(){return function(){}}}}),angular.module("uiFormValidation.providers").provider("uiFormValidation",function(i,o){function t(){this.customValidations=[],this.validationNoticeMode=r.validationNoticeMode,this.validationErrorsMode=r.validationErrorsMode,this.validationErrorsLocation=r.validationErrorsLocation,this.validationErrorsTemplate=r.validationErrorsTemplate,this.formValidations=r.formValidations,this.defaultErrorMessage=r.defaultErrorMessage,angular.forEach(r.supportedValidations,function(i){r.addFormValidation(i)})}var r=this;this.formValidations={},this.validationErrorsTemplate="validation-errors/default.html",this.defaultErrorMessage=function(i){return'Validation "'+i+'" has failed.'};var n=i.get("uiFormValidation.validationErrorsModes");this.validationErrorsMode=[n.onSubmitAndInvalid,n.onDirtyAndInvalid];var a=i.get("uiFormValidation.validationNoticeModes");this.validationNoticeMode=[a.onSubmitAndInvalid,a.onDirtyAndInvalid],this.validationErrorsLocation="after{this}",this.addFormValidation=function(i){this.formValidations[i.validationName]=i,o.directive.apply(null,[i.validationName,function(){return{restrict:"A",require:["^uiValidation","ngModel"],link:function(o,t,n,a){var e=a[0],l=a[1];if(i.performableValidation&&"function"==typeof i.performableValidation,l.$validators)l.$validators[i.validationName]=function(a,s){var d=a||s;return r.validate(d,e,l,i,o,t,n)},l.$validate();else{var s=l.$modelValue||l.$viewValue,d=r.validate(s,e,l,i,o,t,n);d?l.$setValidity(i.validationName,!0):l.$setValidity(i.validationName,!1),l.$parsers.unshift(function(a){var s=r.validate(a,e,l,i,o,t,n);return l.$setValidity(i.validationName,s),a}),l.$formatters.unshift(function(a){var s=r.validate(a,e,l,i,o,t,n);return l.$setValidity(i.validationName,s),a})}}}}])},this.validate=function(i,o,t,r,n,a,e){var l={uiValidationController:o,ngModelController:t,validation:r,scope:n,attrs:e,element:a};return r.validate(i,l)},this.supportedValidations=i.get("uiFormValidation.supportedValidations"),this.$get=[function(){return new t}]}),angular.module("uiFormValidation.services").service("utilsService",function($injector){var $this=this;this.validationErrorsControllers={},this.validationControllers={},this.validationControllerInitializationCallbacks={},this.addValidationErrorsController=function(i,o,t){this.validationErrorsControllers[i]||(this.validationErrorsControllers[i]={},i.$on("$destroy",function(){delete $this.validationErrorsControllers[i]})),this.validationErrorsControllers[i][o]||(this.validationErrorsControllers[i][o]=[]),this.validationErrorsControllers[i][o].push(t)},this.addValidationController=function(i,o){this.validationControllers[i]||(this.validationControllers[i]=[],i.$on("$destroy",function(){delete $this.validationControllers[i]})),this.validationControllers[i][o.controllerName]=o,this.validationControllerInitializationCallbacks[i]&&this.validationControllerInitializationCallbacks[i][o.controllerName]&&(angular.forEach(this.validationControllerInitializationCallbacks[i][o.controllerName],function(i){o.afterInitialized(i)}),delete this.validationControllerInitializationCallbacks[i][o.controllerName])},this.getValidationErrorsLocationFactories=function(){return $injector.get("uiFormValidation.validationErrorsLocationFactories")},this.getValidationErrorsModes=function(){return $injector.get("uiFormValidation.validationErrorsModes")},this.getValidationNoticeModes=function(){return $injector.get("uiFormValidation.validationNoticeModes")},this.selectFromScope=function(scope,selector){return selector=selector.trim(),""!==selector||"this"!==selector?eval("scope."+selector):scope},this.afterValidationControllerInitialized=function(i,o,t){this.validationControllers[i]&&this.validationControllers[i][o]?this.validationControllers[i][o].afterInitialized(t):(this.validationControllerInitializationCallbacks[i]||(this.validationControllerInitializationCallbacks[i]={},i.$on("$destroy",function(){delete $this.validationControllerInitializationCallbacks[i]})),this.validationControllerInitializationCallbacks[i][o]||(this.validationControllerInitializationCallbacks[i][o]=[]),this.validationControllerInitializationCallbacks[i][o].push(t))},this.parseControlErrorsSelectors=function(i){var o={};return angular.forEach(i.split("\\s+"),function(i){var t=/^\s*(.*?)\s*(\{\s*([^\{\}]*?)\s*\})?$/,r=t.exec(i);if(null===r||4!==r.length)throw"Unable to parse input-errors controls.";var n=r[1];o[n]={},o[n].controlName=n,o[n].errors=r[3]?r[3].split(","):undefined,o[n].errors&&(o[n].errors=o[n].errors.map(function(i){return i.trim()}))}),o},this.evalAndParseControlErrorsSelectors=function(i,o){var t=o.split("\\s+");return t=t.map(function(o){return i.$eval(o)}),o=t.join(" "),this.parseControlErrorsSelectors(o)},this.isExpression=function(i){var o=/^\s*\{([^\{\}]*)\}\s*?$/,t=o.exec(i);return null!==t},this.parseExpression=function(i){var o=/^\s*\{([^\{\}]*)\}\s*?$/,t=o.exec(i);return null!==t&&2===t.length?t[1]:undefined}}),angular.module("uiFormValidation.values").value("uiFormValidation.validationErrorsLocationFactories",{after:"uiFormValidation.validationErrorsLocation.after",append:"uiFormValidation.validationErrorsLocation.append",explicit:"uiFormValidation.validationErrorsLocation.explicit"}),angular.module("uiFormValidation").run(["$templateCache",function(i){i.put("validation-errors/default.html",'<div class="alert alert-danger">\r\n    <div ng-repeat="controlErrors in errors">\r\n	    <div class="row" ng-repeat="controlError in controlErrors.errors">\r\n		    <span ng-bind-html="controlError"</span>\r\n	    </div>\r\n	</div>\r\n</div>')}])}(window,document);
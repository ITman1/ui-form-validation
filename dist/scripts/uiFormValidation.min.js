!function(window,document,undefined){"use strict";angular.module("uiFormValidation.constants",[]),angular.module("uiFormValidation.values",[]),angular.module("uiFormValidation.providers",[]),angular.module("uiFormValidation.services",["uiFormValidation.constants","uiFormValidation.values"]),angular.module("uiFormValidation.factories",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services"]),angular.module("uiFormValidation.controllers",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services","uiFormValidation.factories"]),angular.module("uiFormValidation.directives",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services","uiFormValidation.factories","uiFormValidation.controllers"]),angular.module("uiFormValidation",["uiFormValidation.constants","uiFormValidation.values","uiFormValidation.services",,"uiFormValidation.factories","uiFormValidation.controllers","uiFormValidation.directives","uiFormValidation.providers","ngSanitize"]),angular.module("uiFormValidation.factories").factory("uiFormValidation.validationErrorsLocation.after",function(i){return{name:"after",link:function(o,r,t,n){var a=t.controlElement;if(n.length>0){var e=i.selectFromScope(a,n[0]);e&&(a=e)}a.after(r)}}}),angular.module("uiFormValidation.factories").factory("uiFormValidation.validationErrorsLocation.append",function(i){return{name:"append",link:function(o,r,t,n){var a=t.controlElement;if(n.length>0){var e=i.selectFromScope(a,n[0]);e&&(a=e)}a.append(r)}}}),angular.module("uiFormValidation.factories").factory("uiFormValidation.validationErrorsLocation.explicit",function(){return{name:"explicit",compile:function(){return function(){}}}}),angular.module("uiFormValidation.constants").constant("uiFormValidation.supportedValidations",{validateRequired:{validationName:"validateRequired",performableValidation:function(){return!0},validate:function(i){return!!i},errorMessage:function(){return"Field is required."}},validateAdhoc:{validationName:"validateAdhoc",performableValidation:function(){return!0},validate:function(i,o){var r=o.element.attr("validate-adhoc"),t=o.scope.$eval(r);return!t},errorMessage:function(i,o,r){var t=r.controlElement.attr("validate-adhoc"),n=o.$eval(t);return n}},validateLength:{validationName:"validateLength",performableValidation:function(){return!0},validate:function(i,o){return i&&i.length&&i.length>=parseInt(o.element.attr("validate-length"))},errorMessage:function(i,o,r){return"Expected text length with at least "+r.controlElement.attr("validate-length")+" characters."}},validateRegex:{validationName:"validateRegex",performableValidation:function(){return!0},validate:function(i,o){return new RegExp(o.element.attr("validate-regex")).test(i)},errorMessage:function(i,o,r){return"Value does not matches regular expression "+r.controlElement.attr("validate-regex")+"."}}}),angular.module("uiFormValidation.constants").constant("uiFormValidation.validationErrorsModes",{onSubmitAndInvalid:"onSubmitAndInvalid",onDirtyAndInvalid:"onDirtyAndInvalid",onInvalid:"onInvalid"}),angular.module("uiFormValidation.constants").constant("uiFormValidation.validationNoticeModes",{onSubmitAndInvalid:"onSubmitAndInvalid",onDirtyAndInvalid:"onDirtyAndInvalid",onInvalid:"onInvalid"}),angular.module("uiFormValidation.directives").directive("uiValidation",function(i,o,r,t){var n=1;return{restrict:"A",require:["uiValidation","form"],controller:function(i,a,e){var l=r.getValidationErrorsModes(),s=r.getValidationNoticeModes(),d=r.getValidationErrorsLocationFactories(),u=[];angular.forEach(d,function(i){u.push(a.get(i))}),this.controllerName=e.attr("name")||"uiValidation_"+n++,this.initialized=!1,this.isSubmited=!1,this.initializationCallbacks=[],this.formController=undefined,this.formElement=undefined,this.controls={},this.validationNoticeMode=o.validationNoticeMode,this.validationErrorsMode=o.validationErrorsMode,this.validationErrorsLocation=o.validationErrorsLocation,this.validationErrorsTemplate=o.validationErrorsTemplate;var c=this;this.initialize=function(i,o){c.controllerName=i.$name||c.controllerName,c.formController=i,c.formElement=o;var r=i.$addControl;i.$addControl=function(i){r(i),c.addControl(i)},angular.forEach(i,function(i){i&&i.hasOwnProperty("$modelValue")&&c.addControl(i)}),c.initialized=!0,angular.forEach(c.initializationCallbacks,function(i){i()})},this.addControl=function(i){if(i.$name&&""!==i.$name){var o={},r=this.formElement[0].querySelector('[name="'+i.$name+'"]');r=angular.element(r),o.control=i,o.controlElement=r,o.validationNoticeMode=undefined,o.validationErrorsMode=undefined,o.validationErrorsLocation=undefined,o.validationErrorsTemplate=undefined,c.controls[i.$name]=o}},this.afterInitialized=function(i){this.initialized?i():this.initializationCallbacks.push(i)},this.getValidationProperty=function(i,o){if(!c.controls[i])throw"Control with given name "+i+" does not exist.";var r=c.controls[i][o];return r?r:c[o]},this.getValidationErrorsMode=function(i){return this.getValidationProperty(i,"validationErrorsMode")},this.getValidationNoticeMode=function(i){return this.getValidationProperty(i,"validationNoticeMode")},this.getValidationErrorsTemplate=function(i){return this.getValidationProperty(i,"validationErrorsTemplate")},this.getValidationErrorsLocation=function(i){return this.getValidationProperty(i,"validationErrorsLocation")},this.hasControlErrors=function(i){var o=i.controlName,r=i.errors,t=this.controls[o];if(!t)throw"Control with name '"+o+"' does not exist.";var n=!1;return r?angular.forEach(r,function(i){t.control.$error[i]&&(n=!0)}):n=t.control.$invalid,n},this.hasControlsErrors=function(i){var o=!1;return angular.forEach(i,function(i){c.hasControlErrors(i)&&(o=!0)}),o},this.shouldNoticeForControlSelector=function(i){var o=i.controlName,r=this.getValidationNoticeMode(o),t=this.controls[o],n=this.hasControlErrors(i);if(!t)throw"Control with name '"+o+"' does not exist.";var a=!1,e=!1,l=!1;return-1!==r.indexOf(s.onSubmitAndInvalid)&&(a=this.isSubmited&&n),-1!==r.indexOf(s.onDirtyAndInvalid)&&(e=t.control.$dirty&&n),-1!==r.indexOf(s.onInvalid)&&(l=n),a||e||l},this.shouldNoticeForControlSelectors=function(i){var o=!1;return angular.forEach(i,function(i){c.shouldNoticeForControlSelector(i)&&(o=!0)}),o},this.shouldDisplayValidationErrorsForControlSelector=function(i){var o=i.controlName,r=this.getValidationErrorsMode(o),t=this.controls[o],n=this.hasControlErrors(i);if(!t)throw"Control with name '"+o+"' does not exist.";var a=!1,e=!1,s=!1;return-1!==r.indexOf(l.onSubmitAndInvalid)&&(a=this.isSubmited&&n),-1!==r.indexOf(l.onDirtyAndInvalid)&&(e=t.control.$dirty&&n),-1!==r.indexOf(l.onInvalid)&&(s=n),a||e||s},this.shouldDisplayValidationErrorsForControlSelectors=function(i){var o=!1;return angular.forEach(i,function(i){c.shouldDisplayValidationErrorsForControlSelector(i)&&(o=!0)}),o},this.getParsedValidationErrorsLocation=function(i){var o=this.getValidationErrorsLocation(i),r={name:"",args:[]},t=/^\s*(.*?)\s*(\{\s*([^\{\}]*?)\s*\})?$/,n=t.exec(o);if(null===n||4!==n.length)throw"Unable to parse validation errors location - '"+o+"'.";return r.name=n[1].trim(),r.args=n[3]?n[3].split(","):[],r},this.getFormOrControlWrapper=function(i){if(c.formElement[0]===i[0])return c;var o;return angular.forEach(c.controls,function(r){o||r.controlElement[0]!==i[0]||(o=r)}),o},this.injectValidationErrors=function(){angular.forEach(c.controls,function(o,r){var n=angular.element("<div></div>");n.attr("validation-errors",r),n.attr("validation-controller",c.controllerName);var a=c.getParsedValidationErrorsLocation(r);angular.forEach(u,function(r){if(r.name===a.name){var e=null;if(r.compile){if("function"!=typeof r.compile)throw"Validation attribute compile is not function.";e=r.compile(n,a.args)}else e=t(n);e(i,function(t){if(r.link){if("function"!=typeof r.link)throw"Validation attribute link is not function.";r.link(i,t,o,a.args)}})}})})},this.bindSubmitEvent=function(){this.formElement.bind("submit",function(){i.$apply(function(){c.submit()})})},this.validate=function(){angular.forEach(this.controls,function(i){var o=i.control.$viewValue;i.control.$setViewValue(o)})},this.submit=function(){var o=this.formElement.attr("ng-submit");o&&(this.isSubmited=!0,i.$eval(o))}},controllerAs:"uiValidationController",link:function(i,o,t,n){var a=n[0],e=n[1];o.attr("novalidate",!0),a.initialize(e,o),a.injectValidationErrors(),a.bindSubmitEvent(),r.addValidationController(i,a)}}}),angular.module("uiFormValidation.directives").directive("validationController",function(){return{restrict:"A",link:function(i,o,r){if("string"!=typeof r.validationController)throw"Invalid name of the validation controller."}}}),angular.module("uiFormValidation.directives").directive("validationErrors",function(i,o){return{replace:!0,restrict:"A",require:["^?uiValidation","validationErrors"],template:function(){return o.validationErrorsTemplate()},scope:{uiValidationController:"@",$index:"@"},controller:"validationErrorsController",link:function(r,t,n,a){var e=a[0],l=a[1],s=null;s=e?e.controllerName:n.validationController,i.addValidationErrorsController(r,s,l),r.errors={},i.afterValidationErrorsControllerInitialized(r,s,function(){var a=i.validationControllers[r][s],e=l.parseControlErrorsSelectors(n.validationErrors);r.$watch(function(){return a.shouldDisplayValidationErrorsForControlSelectors(e)},function(i){t.toggleClass("hidden",!i)}),angular.forEach(e,function(i){var t=a.controls[i.controlName];if(!t)throw"Undefined control '"+i.controlName+'" to watch.';r.$watchCollection(function(){return t.control.$error},function(){if(i.errors&&i.errors.length<1)return void(r.errors={});var n={};n.control=t.control,n.controlElement=n.controlElement,n.errors={},t.control&&t.control.$error&&angular.forEach(t.control.$error,function(e,l){var s=o.formValidations[l];i.errors&&-1==i.errors.indexOf(l)?delete n.errors[l]:e&&s?n.errors[l]=s.errorMessage(l,r.$parent,t,a):e&&(n.errors[l]=o.defaultErrorMessage(l,r.$parent,t,a))}),r.errors[i.controlName]=n})})})}}}),angular.module("uiFormValidation.directives").directive("validationErrorsLocation",function(){return{restrict:"A",require:"^uiValidation",link:function(i,o,r,t){t.afterInitialized(function(){var i=t.getFormOrControlWrapper(o);if(!i)throw"Unable to get element wrapper. Directive validation-errors-location is not placed probably on the form or input element.";i.validationErrorsLocation=r.validationErrorsLocation})}}}),angular.module("uiFormValidation.directives").directive("validationErrorsMode",function(){return{restrict:"A",require:"^uiValidation",link:function(i,o,r,t){t.afterInitialized(function(){var i=t.getFormOrControlWrapper(o);if(!i)throw"Unable to get element wrapper. Directive validation-errors-mode is not placed probably on the form or input element.";i.validationErrorsMode=r.validationErrorsMode.split("\\s+")})}}}),angular.module("uiFormValidation.directives").directive("validationErrorsTemplate",function(i){return{restrict:"A",require:"uiValidation",link:function(o,r,t,n){var a=i(t.validationErrorsLocation);n.validationErrorsTemplate=a(o)}}}),angular.module("uiFormValidation.directives").directive("validationNotice",function(){return{restrict:"A",require:["^uiValidation","validationNotice"],controller:"validationNoticeController",link:function(i,o,r,t){var n=t[0],a=t[1],e=r.validationNotice,l=a.parseControlErrorsSelectors(e);n.afterInitialized(function(){i.$watch(function(){return n.shouldNoticeForControlSelectors(l)},function(i){o.toggleClass("has-error",i)})})}}}),angular.module("uiFormValidation.directives").directive("validationNoticeMode",function(){return{restrict:"A",require:"^uiValidation",link:function(i,o,r,t){t.afterInitialized(function(){var i=t.getFormOrControlWrapper(o);if(!i)throw"Unable to get element wrapper. Directive validation-notice-mode is not placed probably on the form or input element.";i.validationNoticeMode=r.validationNoticeMode.split("\\s+")})}}}),angular.module("uiFormValidation.directives").directive("validationSubmit",function(i,o){return{restrict:"A",link:function(i,r,t){o.afterValidationErrorsControllerInitialized(i,t.validationSubmit,function(){var n=o.validationControllers[i][t.validationSubmit];r.bind("click",function(){i.$apply(function(){n.submit()})})})}}}),angular.module("uiFormValidation.controllers").controller("validationErrorsController",function(i,o){this.parseControlErrorsSelectors=function(r){return i.isExpression(r)?(r=i.parseExpression(r),i.evalAndParseControlErrorsSelectors(o.$parent,r)):i.parseControlErrorsSelectors(r)}}),angular.module("uiFormValidation.controllers").controller("validationNoticeController",function(i,o){this.parseControlErrorsSelectors=function(r){return i.isExpression(r)?(r=i.parseExpression(r),i.evalAndParseControlErrorsSelectors(o.$parent,r)):i.parseControlErrorsSelectors(r)}}),angular.module("uiFormValidation.values").value("uiFormValidation.validationErrorsLocationFactories",{after:"uiFormValidation.validationErrorsLocation.after",append:"uiFormValidation.validationErrorsLocation.append",explicit:"uiFormValidation.validationErrorsLocation.explicit"}),angular.module("uiFormValidation.providers").provider("uiFormValidation",function(i,o){function r(){this.customValidations=[],this.validationNoticeMode=t.validationNoticeMode,this.validationErrorsMode=t.validationErrorsMode,this.validationErrorsLocation=t.validationErrorsLocation,this.validationErrorsTemplate=t.validationErrorsTemplate,this.formValidations=t.formValidations,this.defaultErrorMessage=t.defaultErrorMessage,angular.forEach(t.supportedValidations,function(i){t.addFormValidation(i)})}var t=this;this.formValidations={},this.validationErrorsTemplate=function(){return'<div class="alert alert-danger"><div ng-repeat="controlErrors in errors"><div class="row" ng-repeat="controlError in controlErrors.errors"><span ng-bind-html="controlError"</span></div></div></div>'},this.defaultErrorMessage=function(i){return'Validation "'+i+'" has failed.'};var n=i.get("uiFormValidation.validationErrorsModes");this.validationErrorsMode=[n.onSubmitAndInvalid,n.onDirtyAndInvalid];var a=i.get("uiFormValidation.validationNoticeModes");this.validationNoticeMode=[a.onSubmitAndInvalid,a.onDirtyAndInvalid],this.validationErrorsLocation="after{this}",this.addFormValidation=function(i){this.formValidations[i.validationName]=i,o.directive.apply(null,[i.validationName,function(){return{restrict:"A",require:["^uiValidation","ngModel"],link:function(o,r,n,a){var e=a[0],l=a[1];if(i.performableValidation&&"function"==typeof i.performableValidation,l.$validators)l.$validators[i.validationName]=function(a,s){var d=a||s;return t.validate(d,e,l,i,o,r,n)},l.$validate();else{var s=l.$modelValue||l.$viewValue,d=t.validate(s,e,l,i,o,r,n);d?l.$setValidity(i.validationName,!0):l.$setValidity(i.validationName,!1),l.$parsers.unshift(function(a){var s=t.validate(a,e,l,i,o,r,n);return l.$setValidity(i.validationName,s),a}),l.$formatters.unshift(function(a){var s=t.validate(a,e,l,i,o,r,n);return l.$setValidity(i.validationName,s),a})}}}}])},this.validate=function(i,o,r,t,n,a,e){var l={uiValidationController:o,ngModelController:r,validation:t,scope:n,attrs:e,element:a};return t.validate(i,l)},this.supportedValidations=i.get("uiFormValidation.supportedValidations"),this.$get=[function(){return new r}]}),angular.module("uiFormValidation.services").service("utilsService",function($injector){var $this=this;this.validationErrorsControllers={},this.validationControllers={},this.validationControllerInitializationCallbacks={},this.addValidationErrorsController=function(i,o,r){this.validationErrorsControllers[i]||(this.validationErrorsControllers[i]={},i.$on("$destroy",function(){delete $this.validationErrorsControllers[i]})),this.validationErrorsControllers[i][o]||(this.validationErrorsControllers[i][o]=[]),this.validationErrorsControllers[i][o].push(r)},this.addValidationController=function(i,o){this.validationControllers[i]||(this.validationControllers[i]=[],i.$on("$destroy",function(){delete $this.validationControllers[i]})),this.validationControllers[i][o.controllerName]=o,this.validationControllerInitializationCallbacks[i]&&this.validationControllerInitializationCallbacks[i][o.controllerName]&&(angular.forEach(this.validationControllerInitializationCallbacks[i][o.controllerName],function(i){o.afterInitialized(i)}),delete this.validationControllerInitializationCallbacks[i][o.controllerName])},this.getValidationErrorsLocationFactories=function(){return $injector.get("uiFormValidation.validationErrorsLocationFactories")},this.getValidationErrorsModes=function(){return $injector.get("uiFormValidation.validationErrorsModes")},this.getValidationNoticeModes=function(){return $injector.get("uiFormValidation.validationNoticeModes")},this.selectFromScope=function(scope,selector){return selector=selector.trim(),""!==selector||"this"!==selector?eval("scope."+selector):scope},this.afterValidationErrorsControllerInitialized=function(i,o,r){this.validationControllers[i]&&this.validationControllers[i][o]?this.validationControllers[i][o].afterInitialized(r):(this.validationControllerInitializationCallbacks[i]||(this.validationControllerInitializationCallbacks[i]={},i.$on("$destroy",function(){delete $this.validationControllerInitializationCallbacks[i]})),this.validationControllerInitializationCallbacks[i][o]||(this.validationControllerInitializationCallbacks[i][o]=[]),this.validationControllerInitializationCallbacks[i][o].push(r))},this.parseControlErrorsSelectors=function(i){var o={};return angular.forEach(i.split("\\s+"),function(i){var r=/^\s*(.*?)\s*(\{\s*([^\{\}]*?)\s*\})?$/,t=r.exec(i);if(null===t||4!==t.length)throw"Unable to parse input-errors controls.";var n=t[1];o[n]={},o[n].controlName=n,o[n].errors=t[3]?t[3].split(","):undefined,o[n].errors&&(o[n].errors=o[n].errors.map(function(i){return i.trim()}))}),o},this.evalAndParseControlErrorsSelectors=function(i,o){var r=o.split("\\s+");return r=r.map(function(o){return i.$eval(o)}),o=r.join(" "),this.parseControlErrorsSelectors(o)},this.isExpression=function(i){var o=/^\s*\{([^\{\}]*)\}\s*?$/,r=o.exec(i);return null!==r},this.parseExpression=function(i){var o=/^\s*\{([^\{\}]*)\}\s*?$/,r=o.exec(i);return null!==r&&2===r.length?r[1]:undefined}})}(window,document);